<!doctype html><html lang=en><head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=keywords content="cdk,aws,cloud,infrastructure,devops">
<meta name=description content="Getting started with AWS CDK - the basics">
<meta name=robots content="index,follow">
<link rel="shortcut icon" href=/img/favicon-32x32.png type=image/x-icon>
<link rel=apple-touch-icon sizes=180x180 href=/img/apple-touch-icon.png>
<link rel=icon type=image/png sizes=32x32 href=/img/favicon-32x32.png>
<link rel=icon type=image/png sizes=16x16 href=/img/favicon-16x16.png>
<link rel=manifest href=/img/site.webmanifest>
<link rel=stylesheet type=text/css href=/css/stylesheet.css>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-ZB67RF9BVH"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-ZB67RF9BVH',{anonymize_ip:!1})}</script>
<title> CDK Demo - Getting Started | greensmith.github.io </title>
</head><body>
<div class=container>
<div class=columns>
<div class=column><div class="content card my-5 has-background-light">
<header class=card-header>
<p class="subtitle card-header-title has-background-info-light">
<span class="image is-24x24 is-inline-block is-hidden-tablet">
<img class="is-rounded is-24x24" src=/img/logo.png alt=howdy!>
</span>
<span class=is-hidden-tablet>
&nbsp;
&nbsp;
</span>
<span style=font-size:1em>
<a href=/>
<i class="fa fa-home"></i> Home
</a>
</span>
<span>
&nbsp;
&nbsp;
</span>
<span style=font-size:1em>
<a href=/about>
<i class="fa fa-info-circle"></i> About
</a>
</span>
</p>
</header>
<div class="card-content is-hidden-mobile">
<div class="columns is-centered">
<div class="column is-narrow">
<div class="card-image has-text-centered">
<figure class="image is-128x128 is-inline-block" style=margin:0;margin-block:0;margin-inline:0>
<img class=is-rounded src=/img/logo.png alt=howdy!>
<figcaption>
Hi!
</figcaption>
</figure>
</div>
</div>
</div>
<div class="columns is-centered is-multiline">
<div class="column is-narrow">
<a href=https://github.com/greensmith title=github target=_blank rel="nofollow noopener">
<i style=font-size:2em;padding:.5em class="fa fa-github" alt=github></i>
</a>
</div>
<div class="column is-narrow">
<a href=https://twitter.com/grnsmth title=twitter target=_blank rel="nofollow noopener">
<i style=font-size:2em;padding:.5em class="fa fa-twitter" alt=twitter></i>
</a>
</div>
<div class="column is-narrow">
<a href=https://youtube.com/channel/UCpfJC7-wHsARIfXmZFU2P3Q title=youtube target=_blank rel="nofollow noopener">
<i style=font-size:2em;padding:.5em class="fa fa-youtube" alt=youtube></i>
</a>
</div>
</div>
</div>
</div>
</div>
<div class="column is-two-thirds">
<div class="content card my-5 has-background-light">
<header class=card-header>
<p class="subtitle card-header-title has-background-info-light">
<span style=color:#363636>
<i class="fa fa-pencil-square-o"></i> CDK Demo - Getting Started
</span>
</p>
</header>
<div class="card-image p2">
<figure class="image is-3by1 sumImgContainer">
<img src=/img/cdk-logo.png alt="CDK Demo - Getting Started">
</figure>
</div>
<div class=card-content>
<div class=media>
<div class=media-content>
<h1 class=title>CDK Demo - Getting Started</h1>
<h2 class=subtitle>Getting started with AWS CDK - the basics</h2>
</div>
</div>
<div class=content>
<span class="tag is-info is-primary">aws</span>
<span class="tag is-info is-primary">cdk</span>
<span class="tag is-info is-primary">cloud</span>
<span class="tag is-info is-primary">devops</span>
<span class="tag is-info is-primary">infrastructure</span>
<br><br>
<time datetime=2/13/22> February 13, 2022</time>
<br><br>
<h2 id=what-is-cdk>what is cdk?</h2>
<p>The Cloud Development Toolkit allows you to generate (in their terms, synthesise) cloudformation templates using other languages such as Typescript, Java or Python.</p>
<p>Using predefined constructs, we can, at a high level, define complicated infrastructure using very little code and let cdk generate the cloudformation template.</p>
<h2 id=prerequisites>prerequisites</h2>
<p>Before we can proceed with installing and using CDK, we must first satisfy the following requirements</p>
<ul>
<li>AWS CLI installed and configured with valid credentials</li>
<li>node.js installed</li>
</ul>
<h2 id=install-cdk>install cdk</h2>
<p>CDK is installed as a node package via the node package manager (NPM)</p>
<p>it&rsquo;s recommended to install this package globally using the -g option</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>npm install -g aws-cdk
</code></pre></div><p>after a short period of time you should be able to confirm the installation was successful and that the cdk command can be executed by checking its version.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cdk --version
</code></pre></div><h2 id=bootstrap>bootstrap</h2>
<p>Now that we have cdk install on our machine, we can begin preparing our AWS account to use it.</p>
<p>The &ldquo;Bootstrapping&rdquo; process adds some default resources to the AWS account and region.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cdk bootstrap  aws//ACCOUNTID/region
</code></pre></div><p>The bootstrap command also provides the opportunity to create trust between multiple accounts and specify the runtime IAM policy that cdk will use (the default is AWSAdministratorAccess policy)</p>
<p>After the bootstrap process is finished, a stack called CDKToolkit should be created in be visible in cloudformation</p>
<figure><img src=cdktoolkit-stack.png><figcaption>
<h4>The new CDKToolkit stack created in cloudformation</h4>
</figcaption>
</figure>
<h2 id=cdk-init>cdk init</h2>
<p>To begin writing CDK code we must first initialise our directory.</p>
<p>The init command provides us with a few options, such as different languages and templates. We&rsquo;ll be deploying using typescript and not specifying any templates.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cdk init --language typescript
</code></pre></div><figure><img src=cdk-init.png><figcaption>
<h4>The CDK Init command, some npm packages might have warnings!</h4>
</figcaption>
</figure>
<p>of the files generated a few important ones are</p>
<ul>
<li>bin/[app].ts
<ul>
<li>this is the entrypoint file for our CDK app</li>
</ul>
</li>
<li>lib/[app]-stack.ts
<ul>
<li>referenced by the bin/app file this will define our cloudformation stack and the resources within it</li>
</ul>
</li>
<li>cdk.json
<ul>
<li>contains instructions and properties for our cdk app. for example context variables can be set in this file rather than passing them as a command line parameter</li>
</ul>
</li>
</ul>
<p>(the placeholder [app] is taken based on the directory the command was executed in)</p>
<h2 id=cdk-diff-and-cdk-deploy>cdk diff and cdk deploy</h2>
<p>Executing the command</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cdk diff
</code></pre></div><p>will tell us what the code and resulting cloudformation template will change in our environment.</p>
<figure><img src=cdk-diff.png><figcaption>
<h4>Even an empty project will still have some metadata to deploy</h4>
</figcaption>
</figure>
<p>As we have not made any changes to our code the resulting cloudformation template will only deploy some cdk parameter settings that are used behind the scenes.</p>
<p>we can deploy this &lsquo;empty&rsquo; template using the command</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cdk deploy
</code></pre></div><figure><img src=cdk-deploy.png><figcaption>
<h4>Deploying the generated cloudformation template</h4>
</figcaption>
</figure>
<p>once deployed if we execute cdk diff again, we can see that no changes are detected.</p>
<figure><img src=cdk-diff-2.png><figcaption>
<h4>Nothing's changed!</h4>
</figcaption>
</figure>
<h2 id=cdk-destory>cdk destory</h2>
<p>To clean up and remove your cdk deployment, execute the destroy command</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cdk destroy
</code></pre></div><p>you will be prompted to confirm, it will will remove the cloudformation resources it created</p>
<figure><img src=cdk-destroy.png><figcaption>
<h4>Removing the cdk resources...</h4>
</figcaption>
</figure>
<p>Some resources may be left behind, for example the default option for S3 buckets is to retain after delete. Plus your bootstrap resources would need to be manually removed via cloudformation (if you did not plan to use cdk again)</p>
<h2 id=next-steps>next steps</h2>
<p>At this stage, we have installed CDK, bootstrapped our account, initialised our code and familiarised ourselves with the diff and deploy commands. Next we will look at deploying some basic infrastructure</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div class=container>
<div class=columns>
<div class="column is-one-fifth">
<div id=bielsa>
<img src=/img/bielsa.png alt=MOT>
<span id=mot>MOT</span>
</div>
</div>
</div>
</div>
</body>
</html>